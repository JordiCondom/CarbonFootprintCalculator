<!DOCTYPE html>
<html>
  <head>
    <title>Input Data</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css">
  </head>
  <body>
  <div class="container">
    <a href="/logout" class="logout-button">Logout</a>
    <h1>Input Data</h1>
    <form action="/input" method="POST">
      <div id="Food">
        <h1>Food</h1>
        <label>What kind of diet do you follow?</label><br>
        <label><input type="radio" name="diet" value="Vegan" required> Vegan </label><br>
        <label><input type="radio" name="diet" value="Vegetarian"> Vegetarian </label><br>
        <label><input type="radio" name="diet" value="Pescetarian"> Pescetarian </label><br>
        <label><input type="radio" name="diet" value="Some_meat"> Some meat (< 50 g/day) </label><br>
        <label><input type="radio" name="diet" value="Regular_meat"> Regular meat (50-100 g/day) </label><br>
        <label><input type="radio" name="diet" value="Heavy_meat"> Heavy meat (> 100 g/day) </label><br><br>
      </div>


      <div id="Transportation">
        <h1>Tranportation</h1>
        <label>What means of transportation have you used?</label><br>
        <label><input type="checkbox" name="meansOfTransportation[]" value="Car"> Car</label><br>
        <label><input type="checkbox" name="meansOfTransportation[]" value="Motorbke"> Motorbike (need to find data?)</label><br>
        <label><input type="checkbox" name="meansOfTransportation[]" value="Bus"> Bus</label><br>
        <label><input type="checkbox" name="meansOfTransportation[]" value="Train"> Train</label><br>
        <label><input type="checkbox" name="meansOfTransportation[]" value="Plane"> Plane</label><br><br>


        <div id="carQuestion" style="display: none;">
        <h2>Car information</h2>
          <label>What kind of energy source does your car use?</label><br>
          <label><input type="radio" name="carType" value="Gasoline">Gasoline</label><br>
          <label><input type="radio" name="carType" value="Diesel">Diesel</label><br>
          <label><input type="radio" name="carType" value="Plug-in Hybrid Electric">Plug-in Hybrid Electric</label><br>
          <label><input type="radio" name="carType" value="Electric">Electric</label><br>
          <label><input type="radio" name="carType" value="I don't know">I don't know</label><br><br>

          <label>How many km did you drive your car for?</label><br>
          <input type="text" name="carDistance"><br><br>
        </div>


        <div id="busQuestion" style="display: none;">
        <h2>Bus information</h2>
          <label>How many km did you use the bus for?</label>
          <input type="text" name="busDistance"><br><br>
        </div>

        <div id="trainQuestion" style="display: none;">
        <h2>Train information</h2>
          <label>How many km did you use the train for?</label>
          <input type="text" name="trainDistance"><br><br>
        </div>

        <div id="planeQuestion" style="display: none;">
          <h2>Flights information</h2>
          <div id="flightContainer">
            <div class="flightInputs">
              <label for="origin">Origin Airport:</label>
              <input type="text" name="origintext" id="originInput" autocomplete="off"><br>
              <label> Look for your origin airport in this list:</label>
              <select name="origin[]" id="originSelect">
              <option value="">Select an origin airport</option>
                  {% for airport in airports %}
                      <option value="{{ airport }}">{{ airport }}</option>
                  {% endfor %}
              </select><br><br><br>

              <label for="destination">Destination Airport:</label>
              <input type="text" name="destinationtext" id="destinationInput" autocomplete="off"><br>
              <label> Look for your destination airport in this list:</label>
              <select name="destination[]" id="destinationSelect">
                <option value="">Select a destination airport</option>
                  {% for airport in airports %}
                      <option value="{{ airport }}">{{ airport }}</option>
                  {% endfor %}
              </select><br><br><br>

              <label for="cabin_class">Cabin Class:</label>
              <select name="cabin_class[]" id="cabin_class">
                  <option value="economy">Economy</option>
                  <option value="premium_economy">Premium Economy</option>
                  <option value="business">Business</option>
                  <option value="first">First</option>
              </select><br><br><br>

              <label for="round_trip">Is it a round trip?</label>
              <select name="round_trip[]" id="roundTripCheckbox">
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select><br><br><br>
              
            </div>
          </div>
          <button type="button" class="buttonblue" onclick="addFlightInput()" id="addFlightButton">Add Flight</button>

        </div>
      </div>
      


      <div id="Housing">
        <h1>Housing</h1>
        <label>(To Do) Housing</label><br>
        <label><input type="radio" name="question3" value="1"> 1</label><br>
        <label><input type="radio" name="question3" value="2"> 2</label><br>
        <label><input type="radio" name="question3" value="3"> 3</label><br><br>
      </div>


      <div id="Consumption">
        <h1>Consumption</h1>
        <label>Considering clothing, shoes, electronics, furniture and other items, how much do you purchase brand-new?</label><br>
        <label><input type="radio" name="shoppingProfile" value="lowShoppingProfile" required>None or just a few in the last year</label><br>
        <label><input type="radio" name="shoppingProfile" value="averageShoppingProfile">Every now and then</label><br>
        <label><input type="radio" name="shoppingProfile" value="highShoppingProfile">Multiple every month, or multiple larger products in the last year</label><br><br>

        <label>Have you bought a smartphone and/or a laptop/computer?</label><br>
        <label><input type="radio" name="phoneLaptopQuestion" value="phoneAndLaptop" required>Phone and laptop/computer</label><br>
        <label><input type="radio" name="phoneLaptopQuestion" value="phone">Phone</label><br>
        <label><input type="radio" name="phoneLaptopQuestion" value="Laptop">Laptop/Computer</label><br>
        <label><input type="radio" name="phoneLaptopQuestion" value="None">None of them</label><br><br>
      </div>


      <div id="Waste">
        <h1>Waste</h1>
        <label>Which of the following materials do you recycle?</label><br>
        <label><input type="checkbox" name="wasteMaterials[]" value="Glass"> Glass</label><br>
        <label><input type="checkbox" name="wasteMaterials[]" value="Plastic"> Plastic</label><br>
        <label><input type="checkbox" name="wasteMaterials[]" value="Paper"> Paper</label><br>
        <label><input type="checkbox" name="wasteMaterials[]" value="OrganicWaste"> Organic waste</label><br>
      </div>

      <input type="submit" value="Submit">
      <a href="/dashboard" class="button">Back to Dashboard</a>
    </form>
  </div>
  <script>
    // Get the input elements for meansOfTransportation and carQuestion

    let flightInputCounter = 0;

    const meansOfTransportationInputs = document.querySelectorAll('input[name="meansOfTransportation[]"]');
    const carQuestion = document.getElementById('carQuestion');
    const busQuestion = document.getElementById('busQuestion');
    const trainQuestion = document.getElementById('trainQuestion');
    const planeQuestion = document.getElementById('planeQuestion');
    const originInput = document.getElementById('originInput');
    const originSelect = document.getElementById('originSelect');
    const destinationInput = document.getElementById('destinationInput');
    const destinationSelect = document.getElementById('destinationSelect');
    

  
    // Add an event listener to the input elements
    meansOfTransportationInputs.forEach(function(input) {
      input.addEventListener('change', function() {
        // Show or hide the car and bus questions based on the selected values
        carQuestion.style.display = isChecked('Car') ? 'block' : 'none';
        busQuestion.style.display = isChecked('Bus') ? 'block' : 'none';
        trainQuestion.style.display = isChecked('Train') ? 'block' : 'none';
        planeQuestion.style.display = isChecked('Plane') ? 'block' : 'none';

        // Reset car, bus, and train inputs when unchecked
        if (!isChecked('Car')) {
          resetCarInputs();
        }
        if (!isChecked('Bus')) {
          resetBusInputs();
        }
        if (!isChecked('Train')) {
          resetTrainInputs();
        }
      });
    });
  
    // Function to check if a specific checkbox is checked
    function isChecked(value) {
      const input = document.querySelector(`input[name="meansOfTransportation[]"][value="${value}"]`);
      return input.checked;
    }
  
    // Additional event listener to handle deselection of "Car" and "Bus"
    carQuestion.addEventListener('change', function() {
      // Hide the car question if "Car" is deselected
      if (!isChecked('Car')) {
        carQuestion.style.display = 'none';
      }
    });
  
    busQuestion.addEventListener('change', function() {
      // Hide the bus question if "Bus" is deselected
      if (!isChecked('Bus')) {
        busQuestion.style.display = 'none';
      }
    });

    trainQuestion.addEventListener('change', function() {
      // Hide the bus question if "Bus" is deselected
      if (!isChecked('Train')) {
        busQuestion.style.display = 'none';
      }
    });

    planeQuestion.addEventListener('change', function() {
      // Hide the plane question if "Plane" is deselected
      if (!isChecked('Plane')) {
        planeQuestion.style.display = 'none';
      }
    })

    // Function to reset car inputs
    function resetCarInputs() {
      const carTypeInputs = document.querySelectorAll('input[name="carType"]');
      const carDistanceInput = document.querySelector('input[name="carDistance"]');

      carTypeInputs.forEach(function(input) {
        input.checked = false;
      });

      carDistanceInput.value = '';
    }

    // Function to reset bus inputs
    function resetBusInputs() {
      const busDistanceInput = document.querySelector('input[name="busDistance"]');
      busDistanceInput.value = '';
    }

    // Function to reset train inputs
    function resetTrainInputs() {
      const trainDistanceInput = document.querySelector('input[name="trainDistance"]');
      trainDistanceInput.value = '';
    }

    // Initialize the select element for origin airport
    originSelect.style.display = 'none';

    // Handle input event on the input element for origin airport
    originInput.addEventListener('input', function() {
        const inputText = this.value.toLowerCase();
        const options = originSelect.options;

        // Show/hide options based on input text for origin airport
        for (let i = 0; i < options.length; i++) {
            const option = options[i];
            const optionText = option.text.toLowerCase();
            if (optionText.indexOf(inputText) > -1) {
                option.style.display = '';
            } else {
                option.style.display = 'none';
            }
        }

        // Show the select element for origin airport if there are matching options, hide it otherwise
        originSelect.style.display = originSelect.options.length > 0 ? '' : 'none';
    });

    // Handle change event on the select element for origin airport
    originSelect.addEventListener('change', function() {
        originInput.value = this.value;
    });




    // Initialize the select element for destination airport
    destinationSelect.style.display = 'none';

    // Handle input event on the input element for destination airport
    destinationInput.addEventListener('input', function() {
        const inputText = this.value.toLowerCase();
        const options = destinationSelect.options;

        // Show/hide options based on input text for destination airport
        for (let i = 0; i < options.length; i++) {
            const option = options[i];
            const optionText = option.text.toLowerCase();
            if (optionText.indexOf(inputText) > -1) {
                option.style.display = '';
            } else {
                option.style.display = 'none';
            }
        }

        // Show the select element for destination airport if there are matching options, hide it otherwise
        destinationSelect.style.display = destinationSelect.options.length > 0 ? '' : 'none';
    });

    // Handle change event on the select element for destination airport
    destinationSelect.addEventListener('change', function() {
        destinationInput.value = this.value;
    });


    function addFlightInput() {
      // Increment the flight input counter for generating unique IDs
      flightInputCounter++;

      // Create a new flightInputs div with the necessary input fields
      const newFlightInputs = document.createElement('div');
      newFlightInputs.className = 'flightInputs';

      newFlightInputs.innerHTML = `
        <div id="flightContainer${flightInputCounter}">
          <div class="flightInputs">
            <h3> New flight </h3>
            <label for="origin">Origin Airport:</label>
            <input type="text" name="origintext" id="originInput${flightInputCounter}" autocomplete="off"><br>
            <label> Look for your origin airport in this list:</label>
            <select name="origin[]" id="originSelect${flightInputCounter}">
              <option value="">Select an origin airport</option>
              {% for airport in airports %}
              <option value="{{ airport }}">{{ airport }}</option>
              {% endfor %}
            </select><br><br><br>

            <label for="destination">Destination Airport:</label>
            <input type="text" name="destinationtext" id="destinationInput${flightInputCounter}" autocomplete="off"><br>
            <label> Look for your destination airport in this list:</label>
            <select name="destination[]" id="destinationSelect${flightInputCounter}">
              <option value="">Select a destination airport</option>
              {% for airport in airports %}
              <option value="{{ airport }}">{{ airport }}</option>
              {% endfor %}
            </select><br><br><br>

            <label for="cabin_class">Cabin Class:</label>
            <select name="cabin_class[]" id="cabin_class${flightInputCounter}">
              <option value="economy">Economy</option>
              <option value="premium_economy">Premium Economy</option>
              <option value="business">Business</option>
              <option value="first">First</option>
            </select><br><br><br>

            <label for="round_trip">Is it a round trip?</label>
            <select name="round_trip[]" id="roundTripCheckbox${flightInputCounter}">
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select><br><br>
          </div>
        </div>

        <button type="button" class="removeFlightButton">Remove Flight</button><br><br>
      `;

      flightContainer.appendChild(newFlightInputs);

      // Attach event listeners to the new input elements
      const originInput = document.getElementById(`originInput${flightInputCounter}`);
      const originSelect = document.getElementById(`originSelect${flightInputCounter}`);
      const destinationInput = document.getElementById(`destinationInput${flightInputCounter}`);
      const destinationSelect = document.getElementById(`destinationSelect${flightInputCounter}`);

      originInput.addEventListener('input', function() {
        handleAirportInput(this, originSelect);
      });

      destinationInput.addEventListener('input', function() {
        handleAirportInput(this, destinationSelect);
      });
    }

    function handleAirportInput(inputElement, selectElement) {
    const inputText = inputElement.value.toLowerCase();
    const options = selectElement.options;

    // Show/hide options based on input text for airport select element
    for (let i = 0; i < options.length; i++) {
      const option = options[i];
      const optionText = option.text.toLowerCase();
      if (optionText.indexOf(inputText) > -1) {
        option.style.display = '';
      } else {
        option.style.display = 'none';
      }
    }

    // Show the select element for airport if there are matching options, hide it otherwise
    selectElement.style.display = selectElement.options.length > 0 ? '' : 'none';
  }


    const flightContainer = document.getElementById('flightContainer');
    flightContainer.addEventListener('click', function(event) {
      if (event.target.classList.contains('removeFlightButton')) {
        const flightInputs = event.target.parentNode;
        flightContainer.removeChild(flightInputs);
      }
    });
  </script>
  </body>
</html>
